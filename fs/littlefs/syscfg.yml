# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
#

syscfg.defs:
    LITTLEFS_FLASH_AREA:
        description: 'Flash area to use for littlefs.'
        type: flash_owner
        value:
        restrictions:
            - $notnull

    LITTLEFS_BLOCK_COUNT:
        description: >
            Number of blocks (sectors) use by this partition.
            If 0, all sectors of littlefs flash ares are used.
        value: 0

    LITTLEFS_BLOCK_SIZE:
        description: >
            Size of the blocks (sectors) on littlefs flash area.
            All blocks shall have the same size.
            If 0, sector size of littlefs flash area is used.
        value: 0

    LITTLEFS_BLOCK_CYCLES:
        description: >
            Number of erase cycles before metadata is moved to another sector
            to reduce wear.
            Equivalent to block_cycles value in littlefs configuration.
        value: 500

    LITTLEFS_AUTO_MOUNT:
        description: >
            Enables mounting of filesystem on init.
        value: 0

    LITTLEFS_AUTO_FORMAT:
        description: >
            Enables (re)formatting of filesystem on mount error.
        value: 0

    LITTLEFS_THREAD_SAFE:
        description: >
            Enables littlefs calls locking to endure thread-safety.
        value: 1

    LITTLEFS_READONLY:
        description: >
            Build littlefs without write support.
        value: 0

    LITTLEFS_DISABLE_INLINED_FILES:
         description: >
             Disables inlined files.
         value: 0

    LITTLEFS_ENABLE_TRACE:
        description: >
            Enabled littlefs internal trace.
            This is only for debugging pruposes and it may create a lot of printouts.
        value: 0

    LITTLEFS_SYSINIT_STAGE:
        description: >
            Sysinit stage for littlefs functionality.
        value: 200

syscfg.restrictions:
    # block size and block count must be both either default or set; block size must be >=128 (littlefs requirement)
    - (LITTLEFS_BLOCK_COUNT == 0 && LITTLEFS_BLOCK_SIZE == 0) || (LITTLEFS_BLOCK_COUNT > 0 && LITTLEFS_BLOCK_SIZE >= 128)
